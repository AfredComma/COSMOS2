{% extends "kosmos/layout.html" %}

{% block content %}

<ul class="breadcrumb">
  <li><a href="{{ url_for('.index') }}">Home</a></li>
  <li><a href="{{ url_for('.execution', id=stage.execution.id ) }}">{{stage.execution}}</a></li>
  <li class="active">{{stage}}</li>
</ul>

<dl class="dl-horizontal">
    {% for k,v in stage.attrs_as_dict().items() %}
    <dt>{{k}}</dt>
    <dd>{{v}}</dd>
    {% endfor %}
</dl>

<div class="panel panel-primary">
  <div class="panel-heading">
      <span class="pull-right"></span>
    <h3 class="panel-title">{{stage}}.tasks</h3>
  </div>
  <div class="panel-body">
<table class="table table-condensed table-striped datatable" id="table_expected">
    <thead>
      <tr>
            <th>id</th>
            <th>task</th>
            <th>successful</th>
            <th>status</th>
            <th>drm_status</th>
            <th>drm_jobid</th>
            <th>attempts</th>
            <th>submitted_on</th>
            <th>finished_on</th>
            <th>wall_time</th>
      </tr>
    </thead>
    <tbody>
      {% for t in stage.tasks %}
      <tr>
            <td>{{t.id}}</td>
            <td><a href="{{ t.url }}">{{t.tags}}</a></td>
            <td>{{t.successful|to_thumb}}</td>
            <td>{{t.status}}</td>
            <td>{{drm_statuses.get(t.drmaa_jobID,'')}}</td>
            <th>{{t.drmaa_jobID}}</th>
            <td>{{t.attempt}}</td>
            <td>{{t.submitted_on}}</td>
            <td>{{t.finished_on}}</td>
            <td>{% if t.finished_on %}{{ t.finished_on - t.started_on|or_datetime_now }}{% endif %}</td>
         </tr>
      {% endfor %}
    </tbody>
</table>

  </div>
</div>


{% endblock %}